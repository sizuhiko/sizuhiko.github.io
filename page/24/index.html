<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>sizuhiko - Technote</title>
    <link rel="shortcut icon" href="/imgages/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/stylesheets/main.css" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/socialite.min.js"></script>
    <script type="text/javascript" src="http://www.scribd.com/javascripts/scribd_api.js"></script>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="/stylesheets/browsers/ie.css" type="text/css">
      <script src="/javascripts/browsers/ie8.js"></script>
      <script defer src="/javascripts/browsers/ie-css3.js"></script>
    <![endif]-->
    <!--[if IE 6]>
      <link rel="stylesheet" href="/styleseets/browsers/ie6.css" type="text/css">
    <![endif]-->
    <!--[if IE 7]>
      <link rel="stylesheet" href="/styleseets/browsers/ie7.css" type="text/css">
    <![endif]-->
    <!--[if IE 8]>
      <link rel="stylesheet" href="/stylesheets/browsers/ie8.css" type="text/css">
    <![endif]-->
    <style type="text/css">
      @media all and (max-width:680px) {
        #blogtools a, #blogtools a:link, #blogtools a:visited { position:relative; top:0; margin:0 0 5px 10px; float:left; background:#f1f1f1; color:#111; border:1px solid #888; }
        #postcontent, #posttitle { width:100%; }
        #qppreview { display:none; }
        #qpsubmit { width:auto !important; float:none; line-height:1.4; height:auto; margin:7px 0; }
        #postform b { display:block; }
        #sharing { float:none; padding-top:3px; }
        }
    </style>
    <style type="text/css">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .cm {
  color: #999988;
  font-style: italic;
}
.highlight .cp {
  color: #999999;
  font-weight: bold;
}
.highlight .c1 {
  color: #999988;
  font-style: italic;
}
.highlight .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #999988;
  font-style: italic;
}
.highlight .err {
  color: #a61717;
  background-color: #e3d2d2;
}
.highlight .gd {
  color: #000000;
  background-color: #ffdddd;
}
.highlight .ge {
  color: #000000;
  font-style: italic;
}
.highlight .gr {
  color: #aa0000;
}
.highlight .gh {
  color: #999999;
}
.highlight .gi {
  color: #000000;
  background-color: #ddffdd;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .gt {
  color: #aa0000;
}
.highlight .kc {
  color: #000000;
  font-weight: bold;
}
.highlight .kd {
  color: #000000;
  font-weight: bold;
}
.highlight .kn {
  color: #000000;
  font-weight: bold;
}
.highlight .kp {
  color: #000000;
  font-weight: bold;
}
.highlight .kr {
  color: #000000;
  font-weight: bold;
}
.highlight .kt {
  color: #445588;
  font-weight: bold;
}
.highlight .k, .highlight .kv {
  color: #000000;
  font-weight: bold;
}
.highlight .mf {
  color: #009999;
}
.highlight .mh {
  color: #009999;
}
.highlight .il {
  color: #009999;
}
.highlight .mi {
  color: #009999;
}
.highlight .mo {
  color: #009999;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #009999;
}
.highlight .sa {
  color: #000000;
  font-weight: bold;
}
.highlight .sb {
  color: #d14;
}
.highlight .sc {
  color: #d14;
}
.highlight .sd {
  color: #d14;
}
.highlight .s2 {
  color: #d14;
}
.highlight .se {
  color: #d14;
}
.highlight .sh {
  color: #d14;
}
.highlight .si {
  color: #d14;
}
.highlight .sx {
  color: #d14;
}
.highlight .sr {
  color: #009926;
}
.highlight .s1 {
  color: #d14;
}
.highlight .ss {
  color: #990073;
}
.highlight .s, .highlight .dl {
  color: #d14;
}
.highlight .na {
  color: #008080;
}
.highlight .bp {
  color: #999999;
}
.highlight .nb {
  color: #0086B3;
}
.highlight .nc {
  color: #445588;
  font-weight: bold;
}
.highlight .no {
  color: #008080;
}
.highlight .nd {
  color: #3c5d5d;
  font-weight: bold;
}
.highlight .ni {
  color: #800080;
}
.highlight .ne {
  color: #990000;
  font-weight: bold;
}
.highlight .nf, .highlight .fm {
  color: #990000;
  font-weight: bold;
}
.highlight .nl {
  color: #990000;
  font-weight: bold;
}
.highlight .nn {
  color: #555555;
}
.highlight .nt {
  color: #000080;
}
.highlight .vc {
  color: #008080;
}
.highlight .vg {
  color: #008080;
}
.highlight .vi {
  color: #008080;
}
.highlight .nv, .highlight .vm {
  color: #008080;
}
.highlight .ow {
  color: #000000;
  font-weight: bold;
}
.highlight .o {
  color: #000000;
  font-weight: bold;
}
.highlight .w {
  color: #bbbbbb;
}
.highlight {
  background-color: #f8f8f8;
}
    </style>
    <script type="text/javascript">
      $(document).ready(function() {
        Socialite.load("blog-social");
      });
    </script>

  </head>
  <body id="myopera" data-twttr-rendered="true">
    <!--[if IE 6]><div class="ie6"><![endif]-->
    <!--[if IE 7]><div class="ie7"><![endif]-->
    <!--[if IE 8]><div class="ie8"><![endif]-->
    <!--[if IE 9]><div class="ie9"><![endif]-->
    <div id="wrap0"><div id="wrap1"><div id="wrap2"><div id="wrap3"><div id="wrap4">

    <div id="top" class="top-blog">
      <div id="top2">
        <h1><a href="/" title="home"><span>Technote</span></a></h1>
        <p id="subtitle"><span>by sizuhiko</span></p>
      </div>
    </div>

    <div id="content" class="blogfront">
      <div id="mainwrap">
        <div id="main">

            <h2 class="title"><a href="/2015/09/13/verbal-expression-php.html">正規表現を簡単に作るには</a></h2>
  <p class="postdate"><a href="/2015/09/13.html" title="Permanent link">Sunday, September 13, 2015 04:11:00 PM</a></p>
  <p class="tags">
      <a href="/tags/php.html" rel="tag">PHP</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p>皆さんは正規表現好きですか？そして得意ですか？
私は好きですが、得意とは言えません。</p>

<h3>VerbalExpressionという選択肢</h3>

<p>そこでVervalExpressionという正規表現を簡単に組むことができる仕組みがあります。</p>

<p><a href="http://verbalexpressions.github.io/">http://verbalexpressions.github.io/</a></p>

<p>サイトに「Regular Expressions made easy」と書いてあるように、簡単に正規表現が作れることを表明しています。
様々な言語にポートされていますが、もちろんPHP版もあります。</p>

<p><a href="https://github.com/VerbalExpressions/PHPVerbalExpressions">https://github.com/VerbalExpressions/PHPVerbalExpressions</a></p>

<p>サイトのサンプルにも書いてあるとおり、以下のようなURLにマッチする正規表現が記述できます。</p>
<div class="highlight"><pre class="highlight php"><code><span class="kn">use</span> <span class="nc">VerbalExpressions\PHPVerbalExpressions\VerbalExpressions</span><span class="p">;</span>

<span class="nv">$regex</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">VerbalExpressions</span><span class="p">;</span>
<span class="nv">$regex</span>  <span class="o">-&gt;</span><span class="nf">startOfLine</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="nf">then</span><span class="p">(</span><span class="s2">"http"</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">maybe</span><span class="p">(</span><span class="s2">"s"</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">then</span><span class="p">(</span><span class="s2">"://"</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">maybe</span><span class="p">(</span><span class="s2">"www."</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">anythingBut</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">endOfLine</span><span class="p">();</span>

<span class="k">echo</span> <span class="nv">$regex</span><span class="o">-&gt;</span><span class="nf">getRegex</span><span class="p">()</span> <span class="mf">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$regex</span><span class="p">,</span> <span class="s1">'http://github.com'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"valid url</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"invalud url</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>1つ目のechoの結果は <code>/^(?:http)(?:s)?(?:\:\/\/)(?:www\.)?(?:[^ ]*)$/m</code> で、2つ目のechoは <code>valid url</code> を表示します。
VerbalExpressionsクラスに <code>toString</code> メソッドが実装されているので、 <code>preg_match</code> 関数でそのまま使えます。</p>

<h3>複雑なことはできるか？</h3>

<p>例えばRFC3986に書いてあるURLパターンをマッチさせようとすると、どうなるでしょうか？
一旦スキーマ部分だけ記述してみます。</p>
<div class="highlight"><pre class="highlight php"><code><span class="nv">$rfc3986</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">VerbalExpressions</span><span class="p">;</span>
<span class="c1">// scheme</span>
<span class="nv">$scheme</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">VerbalExpressions</span><span class="p">;</span>
<span class="nv">$scheme</span><span class="o">-&gt;</span><span class="nf">add</span><span class="p">(</span><span class="s2">"http"</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">maybe</span><span class="p">(</span><span class="s2">"s"</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">_or</span><span class="p">(</span><span class="s2">"ftp"</span><span class="p">);</span>

<span class="nv">$rfc3986</span><span class="o">-&gt;</span><span class="nf">startOfLine</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="nf">add</span><span class="p">(</span><span class="nv">$scheme</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">add</span><span class="p">(</span><span class="s2">"://"</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$rfc3986</span><span class="o">-&gt;</span><span class="nf">getRegex</span><span class="p">()</span> <span class="mf">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
</code></pre></div>
<p>結果は <code>/^(?:\(\?\:http\)\(\?\:s\)\?\)\|\(\?\:ftp)(?:\:\/\/)/m</code> のようになってしまい、期待通りではありません。
この実装は入れ子には対応していないようです。</p>

<h3>もう１つのVerbalExpression実装</h3>

<p>PHPにはもう１つ別のVerbalExpression実装があります。</p>

<p><a href="https://github.com/markwilson/VerbalExpressionsPhp">https://github.com/markwilson/VerbalExpressionsPhp</a></p>

<p>こちらの実装はREADMEに入れ子について記述されているように、入れ子の対応はされているようです。
では早速RFC3986の定義を試してみましょう。</p>
<div class="highlight"><pre class="highlight php"><code><span class="nv">$rfc3986</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">VerbalExpression</span><span class="p">;</span>
<span class="c1">// scheme</span>
<span class="nv">$scheme</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">VerbalExpression</span><span class="p">;</span>
<span class="nv">$scheme</span><span class="o">-&gt;</span><span class="nf">then</span><span class="p">(</span><span class="s2">"http"</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">maybe</span><span class="p">(</span><span class="s2">"s"</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">orPipe</span><span class="p">(</span><span class="s2">"ftp"</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

<span class="nv">$rfc3986</span><span class="o">-&gt;</span><span class="nf">startOfLine</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="nf">find</span><span class="p">(</span><span class="nv">$scheme</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">find</span><span class="p">(</span><span class="s2">"://"</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">endOfLine</span><span class="p">();</span>
<span class="k">echo</span> <span class="nv">$rfc3986</span><span class="o">-&gt;</span><span class="nf">compile</span><span class="p">()</span> <span class="mf">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
</code></pre></div>
<p>結果は <code>^((?:http)(?:s)?()|()(ftp))(\:\/\/)$</code> のようになってしまい、まぁ不正ではないのですが、かなり無駄があります。</p>

<h3>現時点結局のところ</h3>

<p>どちらの実装も簡単なパターンをやるときには良いのですが、ちょっと複雑なパターンを実装しようと思うと微妙です。
大体、簡単なパターンはそのまま正規表現書けば良いじゃん&hellip; という話ですしね。</p>

<h3>目指したいところ</h3>

<p>RubyのVerbalExpressions実装には <a href="http://www.kurtisrainboltgreene.name/hexpress/">HEXPRESS</a> があります。
これはVerbalExpressionsよりさらに便利なヘルパーを備えて <code>Human Expressions, a human way to define regular expressions</code> という標語のとおりより簡単に実装できるように見えます。</p>

<p>これをPHPに移植して使えるようにしようというのが、直近やろうとしていることです。</p>

<h3>さいごに</h3>

<p><a href="http://phpcon.php.gr.jp/2015/">日本PHPカンファレンス2015</a>が10/3(土)に行われます。
私もスピーカーとして登壇しますので、もしご都合がつく方はよろしくお願いします。   </p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="正規表現を簡単に作るには" data-url="http://blog.open.tokyo.jp/2015/09/13/verbal-expression-php.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2015/09/13/verbal-expression-php.html&t=%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE%E3%82%92%E7%B0%A1%E5%8D%98%E3%81%AB%E4%BD%9C%E3%82%8B%E3%81%AB%E3%81%AF" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2015/09/13/verbal-expression-php.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2015/06/14/htmlday-2015.html">htmldayのイベントに参加してきた</a></h2>
  <p class="postdate"><a href="/2015/06/14.html" title="Permanent link">Sunday, June 14, 2015 06:33:00 PM</a></p>
  <p class="tags">
      <a href="/tags/html5.html" rel="tag">HTML5</a>
      <a href="/tags/htmlday.html" rel="tag">htmlday</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p><img src="/images/blog/htmlday2015.jpg" alt="" /></p>

<blockquote>
<p>htmldayとは、日本全国でWebに関する多数のイベントを同じ日（6/13）に開催することで、日本のWebを一層盛り上げようという「お祭り」です。（毎年6月の第2土曜日に開催しています。）</p>
</blockquote>

<p>ということで、以下のイベントに参加してきました。</p>

<p><img src="/images/blog/htmlday2015-events.png" alt="" /></p>

<h3>当日の講演資料</h3>

<p><a href="http://dackdive.hateblo.jp/entry/2015/06/13/161143">まとめサイト</a> ができました。ありがたやー。</p>

<h3>サービスワーカーが今後のフロントエンドを支える</h3>

<p>Google I/Oからの流れもあると思うのですが、サービスワーカー(ServiceWorker)に関連する発表が3連続になったりと、これから取り組まないといけない技術だと思います。
SafariとIEのサポートがまだなのですが、IEに関してはEdgeがChrome相当なので、MSではそちらに期待し、Appleはそのうち対応してくれるのではないかと期待しています。</p>

<p>サービスワーカーとはブラウザにインストールできるタスクで、アプリケーションのバックグラウンドで動作するもので、例えばPush通知とかキャッシュとかオフラインモードの実装なんかをするのに、とても役立つ技術です。</p>

<p>サービスワーカーに関しての詳しい内容はググるとたくさん出てくるので、それらを参照してください。</p>

<h3>気になるキーワード</h3>

<p>発表の中で気になったキーワードと、関連URLを紹介します。</p>

<ul>
<li><a href="http://www.html5rocks.com/ja/tutorials/service-worker/introduction/">Cache API</a>

<ul>
<li>サービスワーカーの紹介記事の中で「Service Worker のインストール」以降にキャッシュを使う例が出ています</li>
</ul></li>
<li><a href="https://developers.google.com/web/updates/2015/03/introduction-to-fetch">Fetch API</a></li>
<li><a href="http://www.w3.org/TR/push-api">Push API</a></li>
<li><a href="https://github.com/google/lovefield">Lovefield</a>

<ul>
<li>Indexed Databaseに対してSQLライクにアクセスできるようにしたライブラリ、Googleが開発した</li>
</ul></li>
<li><a href="https://babeljs.io/">Babel</a>

<ul>
<li>ES6のコードをES5形式にコンパイルしてクロスブラウザで動作できるようにする</li>
<li>gulpとの相性が良いので便利</li>
</ul></li>
<li><a href="http://vorlonjs.com/">VORLON.JS</a>

<ul>
<li>ブラウザをリモートでバッグするツール。マイクロソフトが開発している</li>
<li>スマートフォンのエミュレータを使ったときDOMやJavaScriptのデバッグが難しいが、それをリモートデバッグできるようにする（昔も似た技術はあった気がする）</li>
</ul></li>
<li><a href="http://www.manifoldjs.com/">manifoldjs</a>

<ul>
<li>HTML5アプリケーションを各プラットフォーム用のアプリケーションに変換するツール</li>
<li>Windowsストアアプリ、Androidアプリ、iOSアプリ、Chromeアプリ、FirefoxOSアプリに変換できる</li>
</ul></li>
</ul>

<h3>Polymer1.0がキタ</h3>

<p>そしてPolymerな訳です。私はPolymer大好きで0.5をけっこう弄っていたのですが、1.0は互換性ないということで、個人的な利用にとどめておいて良かったと思っています。</p>

<p>PolymerはWebコンポーネントを実装するための仕組みにフォーカスしているので、いわゆるMVCフレームワークとは違います。
今流行のReact.jsとはかぶる部分が多いと思っています。</p>

<p>Polymerが適用されている実例としては</p>

<ul>
<li>Atavist</li>
<li>salesforce</li>
<li>vaadin</li>
<li>youtube</li>
</ul>

<p>そして今回のGoogle I/Oサイトということだそうです。</p>

<p>で、Polymerを簡単に始めるためには<a href="https://developers.google.com/web/tools/polymer-starter-kit/">Polymer Starter Kit</a>というものがあります。
これを使うと、ブラウザで簡単にPolymerを使ったサイトのディレクトリ構成やファイルの配置、gulpのビルドファイルなどを初期構築できます。
Yeoman的な役割ですね。</p>

<p>Googleが提唱する<a href="http://www.google.com/design/spec/material-design/introduction.html#">Material design</a>をベースにPolymerでサイトを作ると、あらゆるデバイスに最適なGoogle I/Oのようなサイトを作れるので、サイトを例としてPolymerを使ってみるのが良さそうです。</p>

<p>Polymerの注意点としては、ShadowDOMの実装がアレということで、Polymer1.0ではShady DOMという疑似ShadowDOMを実装しています。ShadowDOMと思ってるとそうではないのです。</p>

<h3>最後に</h3>

<p>ServiceWorker、ES6、Polymerあたりの技術は今後重要になってくると思っているので、何か作りたいなーと思う収穫多きイベントでした。</p>

<p>あと懇親会が2度（イベントが午後の部と、夜の部にわかれていたので）あって、おいしいお酒とたくさんのビールに囲まれて幸せでした。
スポンサー様、協賛ありがとうございました！</p>

<p>htmlday 2015 のイベントTシャツをジャンケン大会、最後の最後、ほんとの最後の1枚でGETしました！ありがたやー。早速着てこのBlogを書いています。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="htmldayのイベントに参加してきた" data-url="http://blog.open.tokyo.jp/2015/06/14/htmlday-2015.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2015/06/14/htmlday-2015.html&t=htmlday%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AB%E5%8F%82%E5%8A%A0%E3%81%97%E3%81%A6%E3%81%8D%E3%81%9F" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2015/06/14/htmlday-2015.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2015/06/14/cakefest2015.html">CakeFest2015に参加してきた</a></h2>
  <p class="postdate"><a href="/2015/06/14.html" title="Permanent link">Sunday, June 14, 2015 01:44:00 PM</a></p>
  <p class="tags">
      <a href="/tags/cakephp.html" rel="tag">CakePHP</a>
      <a href="/tags/cakephp3.html" rel="tag">CakePHP3</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p><img src="/images/blog/cakefest2015.jpg" alt="" /></p>

<p>今年はCakePHP生誕10周年ということもあり、かねてよりアニバーサリーCakeFestとも言われていました。</p>

<p>開催場所は世界一の都市ニューヨークです。
私個人でも初のニューヨークです。</p>

<h3>今年の第一印象</h3>

<p>初参加が多い。CakeFestでは毎年会う馴染みの人もいるのですが、今年は特に初参加が多かったようです。
参加者が多い。さすが10周年というべきか、ニューヨークなのでアメリカの人が多かったようです。</p>

<h3>印象に残ったセッション</h3>

<p>昨年までと同様に、CakePHPに関する主なセッションはコアチームから、その他Webに関するトピックをCFPで通ったスピーカーからという流れでした。
今年はコミュニティマネージャのJamesが急に来れなくなってしまい、イベントの仕切りに不安を覚えるスタートだったのですが、Larryが八面六臂の働きで素晴らしいCakeFestになりました。LarryがLTのタイムキーパーやったり、抽選会の司会やったり、それはそれは大活躍でした。</p>

<p>コアチームの中でも</p>

<ul>
<li>Mark Storyのセッション <a href="http://www.slideshare.net/markstory/cakephp-30-and-beyond">CakePHP 3.0.0 and beyond (Conference)</a> </li>
<li>Jose Lorenzo Rodriguezのセッション <a href="http://www.slideshare.net/josezap1/agile-database-access">Agile Database Access with CakePHP 3 (Conference)</a></li>
</ul>

<p>についてはCakePHPを利用する人には一読を薦める内容です。</p>

<h4>Mark Storyのセッション</h4>

<p>とは言えMarkのスライドはいつもの通りお題しか書いていないので、少し詳細にふれておきます。</p>

<ul>
<li>CakePHP3の開発期間3年はとても長かった</li>
<li>周辺の変化

<ul>
<li>PHPのバージョンも変わったし、機能も変わった

<ul>
<li>3年前のPHPは5.4.4(Released: 14 June 2012)あたりです。</li>
<li>現在は5.6.9で、その間にはジェネレータや可変引数などが導入されました。</li>
</ul></li>
<li>他のフレームワークの流れも変わった</li>
</ul></li>
<li>CakePHP3は2ヶ月で8万ダウンロードされた。すごいね。</li>
<li>今後のバージョンの話（詳しくは<a href="https://github.com/cakephp/cakephp/wiki">githubのロードマップ</a>を見てね）

<ul>
<li>PSR-7対応は3.2の予定</li>
</ul></li>
<li>大きく変わったところ

<ul>
<li>Mailers：メール送信がこれまでよりも簡単になる</li>
<li>CLI：出力フォーマットの機能が増える。例えばプログレスバーとか簡単に出せるようになる</li>
<li>ORM：Joseが明日話すけど、関連のロードとかマッチングクエリが書けるようになるよ</li>
<li>ElasticSearch：ORMと似た呼び出し方法が使えるようになる</li>
</ul></li>
<li>今後注力していくところ

<ul>
<li>プラグインのリリース</li>
<li>3.x系の開発

<ul>
<li>これにより2系については3からのバックポートが中心となる</li>
<li>3.x内での互換性は重視している</li>
</ul></li>
<li>PHP7</li>
</ul></li>
</ul>

<h4>Jose Lorenzo Rodriguezのセッション</h4>

<p>Joseのセッションはコード多めで、解説だけではわかりづらいと思うのでサンプルコードが提供されています。</p>

<p><a href="https://github.com/lorenzo/cakephp3-advanced-examples">サンプルコード::github</a></p>

<p>スライドの最初に出てくる3つのタイプのORM</p>

<ul>
<li>いらっとする</li>
<li>おもちゃみたいな</li>
<li>流行の（通の）</li>
<li>すばらしい</li>
</ul>

<p>もちろんCakePHP3のORMは<code>すばらしい</code>ものだよ。という流れで掴みはOKな展開。ちなみにQ&amp;AでDoctrineは？という質問に「Hipster」と即座に回答していました。
ちなみに日本だとAgileはアジャイルと発音するけど、Joseのセッションではずっとエイジールと聞こえていた。</p>

<p>スライドやサンプルを見てもらえると、CakePHP3のORMがかなり強力になっているのがわかると思います。
特に気になったのは</p>

<ul>
<li>タイプヒント</li>
<li>カスタムファインダー</li>
<li>集合検索</li>
<li>多重階層の集合検索</li>
<li>他のDBへのアソシエーション定義</li>
<li>バーチャルフィールド</li>
</ul>

<p>あたりです。サンプルを使って実際に動かしてみるのが良いですね。まだ全部試せていないけど、CakePHP3もくもく会で少しずつ試せたら良いなーと思っています。</p>

<h3>10周年</h3>

<p>ノベルティが久々にたくさんあった。きっとシカゴ以来。</p>

<blockquote class="twitter-tweet" lang="ja"><p lang="tl" dir="ltr">Swag at <a href="https://twitter.com/hashtag/CakeFest2015?src=hash">#CakeFest2015</a> <a href="http://t.co/gVbDL5ctPl">pic.twitter.com/gVbDL5ctPl</a></p>&mdash; CakePHP (@cakephp) <a href="https://twitter.com/cakephp/status/604985701025869824">2015, 5月 31</a></blockquote>

<p>で、私はそのシカゴから参加して6回目の参加となりました。
最後の抽選会でシカゴに参加した人、というときに私含め3人しか立たなかった（コアチームは除く）。さらにそのうち1人はマリアーノです。</p>

<p>アニバーサリーということで最後の目玉商品は来年のCakeFest招待券！！。なんと交通費込み（上限あるけど）。
当選者は</p>

<blockquote class="twitter-tweet" lang="ja"><p lang="en" dir="ltr">The winners of free tickets to <a href="https://twitter.com/hashtag/CakeFest2016?src=hash">#CakeFest2016</a> <a href="http://t.co/FvB3olZCgN">pic.twitter.com/FvB3olZCgN</a></p>&mdash; CakePHP (@cakephp) <a href="https://twitter.com/cakephp/status/605408000073965568">2015, 6月 1</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>奥山さん！！！、来年はVIP待遇ですなー。来年はドイツらしいですよ。</p>

<h3>感謝</h3>

<p>10周年ということで、ここ数年は安藤さんと私の2人だったのを、もっと多くのCakePHPユーザにCakeFestに参加して欲しいと思い、様々なところでくどいぐらい誘いました（ご迷惑だった皆様すみません）。結果、私含め5人が日本から参加ということで、とても楽しかったです。</p>

<p>安藤さんの紹介で、pivotal lab.にも訪問できたし、ピザ屋さんも（すごい）美味しかったです。</p>

<p>また、日本でCakeRadioGaGaの中継を受け取ってくれたCo-Edoの田中さん、中継を見てくれた皆様、ありがとうございました。
別途報告会（もくもく会の中で？）、できたら良いなーと思っています。</p>

<p>そのほかGoogle社の前で写真撮ったり、チェルシーマーケットでおみやげ買ったり、MOMA行ったり、ちゃんとニューヨークも楽しむことができました。</p>

<p>最後に、CakeRadioGaGaの中継動画を。そういえばMarkとJoseに今年もメッセージちょうだいと言っていたのに、すっかり忘れたのは内緒です&hellip;</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/VSwEo9VIi2A" frameborder="0" allowfullscreen></iframe>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="CakeFest2015に参加してきた" data-url="http://blog.open.tokyo.jp/2015/06/14/cakefest2015.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2015/06/14/cakefest2015.html&t=CakeFest2015%E3%81%AB%E5%8F%82%E5%8A%A0%E3%81%97%E3%81%A6%E3%81%8D%E3%81%9F" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2015/06/14/cakefest2015.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2015/05/17/cakephp3-behat.html">CakePHP3 のアプリケーションを Behat でテストする</a></h2>
  <p class="postdate"><a href="/2015/05/17.html" title="Permanent link">Sunday, May 17, 2015 05:21:00 PM</a></p>
  <p class="tags">
      <a href="/tags/cakephp3.html" rel="tag">CakePHP3</a>
      <a href="/tags/bdd.html" rel="tag">BDD</a>
      <a href="/tags/behat.html" rel="tag">Behat</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p><img src="/images/blog/cakephp3_behat.png" alt="" /></p>

<p>CakePHP3の変更点として大きく取り上げられるのが、モデル層の変更でしょう。
しかしそれ以上に私たちが受けられる恩恵で大きいのが、PSR-2の採択です。</p>

<p><a href="http://bakery.cakephp.org/2014/12/16/CakePHP-3-to-fully-adopt-PSR-2.html">CakePHP3 is fully adopt PSR-2</a></p>

<p>例えばCakePHP2で単体テストを実行するときは、以下のように<code>cake</code>コマンドを使って実行する必要がありました。</p>
<div class="highlight"><pre class="highlight plaintext"><code>Console/cake test app Model/Articles
</code></pre></div>
<p>cakeコマンド内でPHPUnitへの依存関係を解決し、PHPUnitからCakePHPのクラスが参照可能になるように作られていました。</p>

<p>ところがCakePHP3からは、以下のように<code>phpunit</code>コマンドを使って実行します。</p>
<div class="highlight"><pre class="highlight plaintext"><code>vendor/bin/phpunit
</code></pre></div>
<p>PSR-0のオートロードに対応したことで、PHPUnitからCakePHP3のクラスが参照可能になるのです。</p>

<h3>はじめてみよう</h3>

<p>同様の理由で、CakePHP2のアプリケーションをBehatでテストしたい場合は、私が作成した<a href="https://github.com/sizuhiko/Bdd">Bdd Plugin</a>を使ってBehatのステップ記述からCakePHPのクラスを参照可能になるようにしていました。</p>

<p>しかしBehatにおいても直接実行したステップ定義から、CakePHP3のクラスが参照可能になるのです。</p>

<p>CakePHP3のアプリケーションをどのようにBehatからアクセスするのか、CakePHP3のブログチュートリアルを例にサンプルアプリを作成しました。</p>

<p><a href="https://github.com/sizuhiko/cakephp3-bdd-example">cakephp3-bdd-example</a>    </p>

<p>サンプルアプリケーションは<a href="/2015/04/19/cakebox-is-awesome.html">以前記事</a>にもした<a href="https://github.com/alt3/cakebox">Cakebox</a>を使って構築しました。
またサンプルアプリケーションの実行にもCakeboxを使うと簡単に実行環境を構築することができます。</p>

<p>サンプルアプリケーションのGithubページに書いてあるとおりの手順で進むことができます。
本ブログでは日本語で補足します。</p>

<h4>必要なアプリケーションのインストール</h4>

<p>以下のアプリケーションをホストOSにインストールします。</p>

<ul>
<li>VirtualBox</li>
<li>Vagrant</li>
<li>Cakebox</li>
</ul>

<p>詳しくは<a href="/2015/04/19/cakebox-is-awesome.html">Cakebox を使ってCakePHP3アプリケーションを作ってみよう</a>の記事を参照してください。</p>

<h4>サンプルアプリケーションのインストール</h4>

<p>CakeboxのゲストOSにログインして、cakeboxコマンドでアプリケーションをインストールします。</p>
<div class="highlight"><pre class="highlight plaintext"><code>localhost:cakebox $ vagrant ssh
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-24-generic x86_64)

vagrant@cakebox $ cakebox application add blog-tutorial.app --source https://github.com/sizuhiko/cakephp3-bdd-example.git --webroot blog-tutorial.app
</code></pre></div>
<p>すると、以下のように表示されます。</p>
<div class="highlight"><pre class="highlight plaintext"><code>Creating application http://blog-tutorial.app

Configuring installer
Creating installation directory
Git installing user specified application sources
Creating virtual host
* Successfully created PHP-FPM virtual host
Creating databases
* Successfully created main database
* Successfully created test database
Configuring permissions
Updating configuration files
Application created using:
  database =&gt; blog-tutorial_app
  framework_human =&gt; user specified
  framework_short =&gt; custom
  installation_method =&gt; git
  path =&gt; /home/vagrant/Apps/blog-tutorial.app
  source =&gt; https://github.com/sizuhiko/cakephp3-bdd-example.git
  url =&gt; blog-tutorial.app
  webroot =&gt; blog-tutorial.app
Please note:
  =&gt; Configuration files are not automatically updated for user specified applications.
  =&gt; Make sure to manually update your database credentials, plugins, etc.

Remember to update your hosts file with: 10.33.10.10 http://blog-tutorial.app

Installation completed successfully
</code></pre></div>
<p>新規アプリケーションの構築と同じように、データベースやNginxの設定ファイルも生成してくれるので、すぐにアプリケーションを実行できる環境が整います。</p>

<p>あとはアプリケーションのルートディレクトリに移動して、不足しているディレクトリを作ってcomposerでライブラリをインストールします。</p>
<div class="highlight"><pre class="highlight plaintext"><code>vagrant@cakebox $ cd Apps/blog-tutorial.app
vagrant@cakebox:~/Apps/blog-tutorial.app$ mkdir tmp 
vagrant@cakebox:~/Apps/blog-tutorial.app$ mkdir logs
vagrant@cakebox:~/Apps/blog-tutorial.app$ cp config/app.default.php config/app.php
vagrant@cakebox:~/Apps/blog-tutorial.app$ composer install 
</code></pre></div>
<h4>サンプルアプリケーションの環境設定</h4>

<h5>データベース接続設定の変更</h5>

<p><code>config/app.php</code>のデータベース接続設定をCakeboxで生成された内容に変更します。
以下のとおり<code>username</code>と<code>database</code>の部分のみ変更します（それ以外はそのまま）。</p>
<div class="highlight"><pre class="highlight php"><code>    <span class="s1">'Datasources'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'default'</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="c1">// 省略</span>
            <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'cakebox'</span><span class="p">,</span>
            <span class="s1">'database'</span> <span class="o">=&gt;</span> <span class="s1">'blog-tutorial_app'</span><span class="p">,</span>
            <span class="c1">// 省略</span>
        <span class="p">],</span>
        <span class="s1">'test'</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="c1">// 省略</span>
            <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'cakebox'</span><span class="p">,</span>
            <span class="s1">'database'</span> <span class="o">=&gt;</span> <span class="s1">'test_blog-tutorial_app'</span><span class="p">,</span>
            <span class="c1">// 省略</span>
        <span class="p">],</span>
</code></pre></div>
<h5>ホストOSのhostsファイルの変更</h5>

<p>ホストOSのhostsファイルに指示されたように <code>10.33.10.10 blog-tutorial.app</code> の行を追加します。</p>

<h5>Cakebox環境のチューニング</h5>

<p>Cakeboxのデフォルト設定ではBehatを使ってアプリケーションをテストしようとすると、いくつか動かない箇所があったので、設定値をチューニングします。
まずボックスファイルのメモリを2048Mにアップします（デフォルトは1024M）。
次にxdebug.iniのxdebug.max<em>nesting</em>levelの値を調整します。READMEでは<code>500</code>を設定しています。もう少し値は小さくても大丈夫かもしれないですが、とりあえず500あれば大丈夫です。</p>

<p>具体的な設定例は、githubのREADMEを参照してください。</p>

<h5>Webサーバの設定</h5>

<p>Behatからアプリケーションをテストするときは、ブラウザから通常操作するのと同じようにWebサーバを通過します。
そのため、アプリケーションが通常操作としてアクセスされたのか、Behatのテストでアクセスされたのかを識別して環境を切り替えてあげないと、データベースのデータがテストによって変更するので、通常操作のデータが失われてしまいます。</p>

<p>このあたりの話（理由や手法）は、過去に何度か記事にしていたり、書籍<a href="http://www.amazon.co.jp/CakePHP%E3%81%A7%E5%AD%A6%E3%81%B6%E7%B6%99%E7%B6%9A%E7%9A%84%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B0%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3-%E6%B8%A1%E8%BE%BA-%E4%B8%80%E5%AE%8F/dp/4844336789/ref=la_B004LVAF8Q_1_1?s=books&amp;ie=UTF8&amp;qid=1410066610&amp;sr=1-1">CakePHPで学ぶ継続的インテグレーション</a>でも詳しく解説していますので、CakePHP2の内容ですが、一度手に取ってみてください。</p>

<p>で、このサンプルはnginx用の設定ファイルを<code>blog-tutorial.app.test</code>というファイルで用意しておいたので、これをCakeboxのnginxの設定ディレクトリにコピーして再起動するだけで大丈夫です。</p>

<p>環境切り替え用に<code>blog-tutorial.app.test</code>というホスト名でアクセスされたら、nginxで環境変数<code>CAKE_ENV</code>に<code>test</code>という文字列を設定するようにしています。
CakePHP3のアプリケーションでは<code>config/bootstrap.php</code>で環境変数の設定値を見てDBの接続先が<code>test</code>になるように設定します。</p>
<div class="highlight"><pre class="highlight php"><code><span class="k">if</span> <span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">'CAKE_ENV'</span><span class="p">)</span> <span class="o">===</span> <span class="s1">'test'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">ConnectionManager</span><span class="o">::</span><span class="nf">alias</span><span class="p">(</span><span class="s1">'test'</span><span class="p">,</span> <span class="s1">'default'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>CakePHP3ではConnectionManagerのaliasという機能でdefaultへ接続しようとしたときに、実際はtestの接続内容を参照するように設定することができるので、この機能を利用し、間違ってdefaultのテーブルが書き変わらないようにしています。</p>

<p>より詳しい手順や、設定ファイルの内容はgithubのREADMEや設定ファイルを参照してください。</p>

<p>Behatから参照可能なホスト名として<code>blog-tutorial.app.test</code>をCakeboxのVM側の<code>/etc/hosts</code>に追加します。</p>

<h4>データベースのマイグレーション</h4>

<p>データベースの生成はマイグレーションコマンドで一発です。</p>
<div class="highlight"><pre class="highlight plaintext"><code>bin/cake migrations migrate
</code></pre></div>
<h4>Behatのテストを実行する</h4>

<p>ここまで設定できれば、後はテストを実行するだけです。</p>
<div class="highlight"><pre class="highlight plaintext"><code>vagrant@cakebox:~/Apps/blog-tutorial.app$ vendor/bin/behat
</code></pre></div>
<p>おそらくすべてグリーンで成功するはずです。
うまくいかなかったら、お気軽にgithubのissueに<code>日本語で</code>書いてください。</p>

<h3>どうやったのか？</h3>

<p>まずCakePHP3で最初に注目したのは、単体テストがPHPUnitのコマンドから実行できるようになっていたことです。
これは過去に外部の様々なツールやアプリケーションとCakePHPを結合するときに一番悩んでいたところでした。</p>

<p>PHPUnitからCakePHP3にどのように連動しているのか？を調べることから始めました。
PHPUnitは実行すると、カレントディレクトリのphpunit.xml（もしくはphpunit.xml.dist）を参照します。</p>

<h4>PHPUnitがCakePHP3を呼び出す仕組みを知る</h4>

<p>CakePHP3ではアプリケーションスケルトンを生成すると、ルートディレクトリに<code>phpunit.xml.dist</code>が生成されます。</p>
<div class="highlight"><pre class="highlight xml"><code><span class="c">&lt;!-- phpunit.xml.dist --&gt;</span>
<span class="nt">&lt;phpunit</span>
    <span class="na">colors=</span><span class="s">"true"</span>
    <span class="na">processIsolation=</span><span class="s">"false"</span>
    <span class="na">stopOnFailure=</span><span class="s">"false"</span>
    <span class="na">syntaxCheck=</span><span class="s">"false"</span>
    <span class="na">bootstrap=</span><span class="s">"./tests/bootstrap.php"</span>  <span class="err">//</span> <span class="err">(1)</span>
    <span class="nt">&gt;</span>
    <span class="nt">&lt;php&gt;</span>
        <span class="nt">&lt;ini</span> <span class="na">name=</span><span class="s">"memory_limit"</span> <span class="na">value=</span><span class="s">"-1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ini</span> <span class="na">name=</span><span class="s">"apc.enable_cli"</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/php&gt;</span>

    <span class="c">&lt;!-- Add any additional test suites you want to run here --&gt;</span>
    <span class="nt">&lt;testsuites&gt;</span>
        <span class="nt">&lt;testsuite</span> <span class="na">name=</span><span class="s">"App Test Suite"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;directory&gt;</span>./tests/TestCase<span class="nt">&lt;/directory&gt;</span>
        <span class="nt">&lt;/testsuite&gt;</span>
        <span class="c">&lt;!-- Add plugin test suites here. --&gt;</span>
    <span class="nt">&lt;/testsuites&gt;</span>

    <span class="c">&lt;!-- Setup a listener for fixtures (2) --&gt;</span>
    <span class="nt">&lt;listeners&gt;</span>
        <span class="nt">&lt;listener</span>
        <span class="na">class=</span><span class="s">"\Cake\TestSuite\Fixture\FixtureInjector"</span>
        <span class="na">file=</span><span class="s">"./vendor/cakephp/cakephp/src/TestSuite/Fixture/FixtureInjector.php"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;arguments&gt;</span>
                <span class="nt">&lt;object</span> <span class="na">class=</span><span class="s">"\Cake\TestSuite\Fixture\FixtureManager"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/arguments&gt;</span>
        <span class="nt">&lt;/listener&gt;</span>
    <span class="nt">&lt;/listeners&gt;</span>
<span class="nt">&lt;/phpunit&gt;</span>
</code></pre></div>
<p>このファイルを読むと、2つ重要な箇所があるのに気がつきます。</p>

<p>まず(1)の <code>bootstrap=&quot;./tests/bootstrap.php&quot;</code> という部分。
bootstrap属性にはPHPUnitが実行されるとき呼び出されるPHPコードを指定することができます。
ここからCakePHP3アプリケーションをテスト用にロードする場合、このファイルを呼び出せば外部ツールからCakePHP3が操作できるようになることがわかります。</p>

<p>実はこのファイルを実際に見てみると、以下の1行しかありません。</p>
<div class="highlight"><pre class="highlight php"><code><span class="k">require</span> <span class="nb">dirname</span><span class="p">(</span><span class="k">__DIR__</span><span class="p">)</span> <span class="mf">.</span> <span class="s1">'/config/bootstrap.php'</span><span class="p">;</span>
</code></pre></div>
<p>テストとは関係なく、アプリケーションの<code>config/bootstrap.php</code>をロードしています。
おそらく将来テストに関する何か差分が必要になったときに、テスト側にだけ変更が発生すると思うので、テスト用にCakePHP3をロードする場合は<code>tests/bootstrap.php</code>をロードしておいた方が良いでしょう。</p>

<p>次に(2)のリスナー設定です。
PHPUnitのリスナーはPHPUnitのフックポイントでコールバックされる処理を記述できるクラスです。
CakePHP3ではフィクスチャ（DBのテストテーブルとデータを準備する仕組み）を投入するのに利用しています。
以下のように<code>FixtureInjector</code>クラスのstartTestとendTestでテストケース開始／終了ごとにフィクスチャのロードとアンロードが対応するようになっています。</p>
<div class="highlight"><pre class="highlight php"><code><span class="kd">class</span> <span class="nc">FixtureInjector</span> <span class="kd">implements</span> <span class="nc">PHPUnit_Framework_TestListener</span>
<span class="p">{</span>

    <span class="cd">/**
     * Adds fixtures to a test case when it starts.
     *
     * @param \PHPUnit_Framework_Test $test The test case
     * @return void
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">startTest</span><span class="p">(</span><span class="kt">PHPUnit_Framework_Test</span> <span class="nv">$test</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$test</span><span class="o">-&gt;</span><span class="n">fixtureManager</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">_fixtureManager</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$test</span> <span class="k">instanceof</span> <span class="nc">TestCase</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">_fixtureManager</span><span class="o">-&gt;</span><span class="nf">fixturize</span><span class="p">(</span><span class="nv">$test</span><span class="p">);</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">_fixtureManager</span><span class="o">-&gt;</span><span class="nf">load</span><span class="p">(</span><span class="nv">$test</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Unloads fixtures from the test case.
     *
     * @param \PHPUnit_Framework_Test $test The test case
     * @param float $time current time
     * @return void
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">endTest</span><span class="p">(</span><span class="kt">PHPUnit_Framework_Test</span> <span class="nv">$test</span><span class="p">,</span> <span class="nv">$time</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$test</span> <span class="k">instanceof</span> <span class="nc">TestCase</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">_fixtureManager</span><span class="o">-&gt;</span><span class="nf">unload</span><span class="p">(</span><span class="nv">$test</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<h4>BehatからCakePHP3を呼び出す仕組みに流用する</h4>

<p>ここまでの内容が外部ツールからCakePHP3のアプリケーションをテストするのに重要な部分です。
PHPUnitがCakePHP3を呼び出すのと同じようにする仕組みをBehatのFeatureContextクラスに用意します。</p>

<p><code>features/bootstrap/FeatureContext.php</code>というBehatが読み込むファイルに記述します。
CakePHP2とBDDプラグインによるインテグレーションではBehatのバージョンが2系でしたが、CakePHP3との連携では最新の3系を利用しています。
Behat3からはBehat1系、2系で利用していたファイル構成と異なっています。従来、<code>support/bootstrap.php</code>や<code>support/hooks.php</code>あたりに書いていたコードはすべてContextクラス内に記述することになります。</p>

<p>Behat3からはFeatureContextにブートストラップ記述を、それ以外のコンテキストは用途に応じて別のコンテキストクラスに分割する方がスマートに記述できそうです。
Behat2では複数のコンテキストクラスを使う場合、FeatureContextでインクルードしないといけなかったのですが、Behat3では<code>behat.yml</code>上で記述できるのでより簡単になっています。</p>
<div class="highlight"><pre class="highlight php"><code><span class="kd">class</span> <span class="nc">FeatureContext</span> <span class="kd">implements</span> <span class="nc">Context</span><span class="p">,</span> <span class="nc">SnippetAcceptingContext</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">require_once</span> <span class="nb">dirname</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__DIR__</span><span class="p">))</span> <span class="mf">.</span> <span class="s1">'/tests/bootstrap.php'</span><span class="p">;</span> <span class="c1">// (1)</span>

        <span class="c1">// Always connect test database</span>
        <span class="nc">ConnectionManager</span><span class="o">::</span><span class="nf">alias</span><span class="p">(</span><span class="s1">'test'</span><span class="p">,</span> <span class="s1">'default'</span><span class="p">);</span> <span class="c1">// (2)</span>

        <span class="nc">Fabricate</span><span class="o">::</span><span class="nf">config</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$config</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// (3)</span>
            <span class="nv">$config</span><span class="o">-&gt;</span><span class="n">adaptor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CakeFabricateAdaptor</span><span class="p">([</span>
                <span class="nc">CakeFabricateAdaptor</span><span class="o">::</span><span class="no">OPTION_FILTER_KEY</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nc">CakeFabricateAdaptor</span><span class="o">::</span><span class="no">OPTION_VALIDATE</span>   <span class="o">=&gt;</span> <span class="kc">false</span>
            <span class="p">]);</span>
        <span class="p">});</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">fixtureInjector</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FixtureInjector</span><span class="p">(</span><span class="k">new</span> <span class="nc">FixtureManager</span><span class="p">());</span> <span class="c1">//(4)</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">fixture</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BddAllFixture</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>(1)は、phpunit.xmlのbootstrapと同様にCakePHP3の<code>tests/bootstrap.php</code>を呼び出します。</li>
<li>(2)は、Behatのステップ定義からテストデータを投入するときに、testの接続設定を参照するようにエイリアスを設定します。</li>
<li>(3)は、テストデータジェネレータ<a href="https://github.com/sizuhiko/cakephp-fabricate-adaptor">Fabricate</a>の初期設定です。FabricateもCakePHP3対応されています。</li>
<li>(4)は、phpunit.xmlのリスナー部分を模して、Behatのシナリオ毎にフィクスチャが動くようにFixtureInjectorのインスタンスを生成しています。</li>
</ul>

<h4>BehatからCakePHP3のフィクスチャを利用する</h4>

<p>(4)で書いたとおり、FixtureInjectorのインスタンスを生成したので、Behatのフックポイントを使ってシナリオ開始時にフィクスチャをロードし、シナリオ終了時にフィクスチャをアンロードするようにします。</p>
<div class="highlight"><pre class="highlight php"><code>    <span class="cd">/** @BeforeScenario */</span>
     <span class="k">public</span> <span class="k">function</span> <span class="n">beforeScenario</span><span class="p">(</span><span class="kt">BeforeScenarioScope</span> <span class="nv">$scope</span><span class="p">)</span>
     <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">fixtureInjector</span><span class="o">-&gt;</span><span class="nf">startTest</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">fixture</span><span class="p">);</span>
     <span class="p">}</span>

     <span class="cd">/** @AfterScenario */</span>
     <span class="k">public</span> <span class="k">function</span> <span class="n">afterScenario</span><span class="p">(</span><span class="kt">AfterScenarioScope</span> <span class="nv">$scope</span><span class="p">)</span>
     <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">fixtureInjector</span><span class="o">-&gt;</span><span class="nf">endTest</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">fixture</span><span class="p">,</span> <span class="nb">time</span><span class="p">());</span>
     <span class="p">}</span>
</code></pre></div>
<p>実際にフィクスチャを利用するためには、<code>$this-&gt;fixture</code>のクラスがCakePHP3のTestCaseでなければならないので、<code>$fixtures</code>という利用するフィクスチャファイルの配列を定義しただけのクラスを用意してFixtureInjectorに渡すようにします。</p>
<div class="highlight"><pre class="highlight php"><code><span class="kd">class</span> <span class="nc">BddAllFixture</span> <span class="kd">extends</span> <span class="nc">TestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'Categories'</span> <span class="o">=&gt;</span> <span class="s1">'app.categories'</span><span class="p">,</span>
        <span class="s1">'Articles'</span>   <span class="o">=&gt;</span> <span class="s1">'app.articles'</span><span class="p">,</span>
        <span class="s1">'Users'</span>      <span class="o">=&gt;</span> <span class="s1">'app.users'</span><span class="p">,</span>
        <span class="s1">'Categories'</span> <span class="o">=&gt;</span> <span class="s1">'app.categories'</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>このあたりの話も、書籍<a href="http://www.amazon.co.jp/CakePHP%E3%81%A7%E5%AD%A6%E3%81%B6%E7%B6%99%E7%B6%9A%E7%9A%84%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B0%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3-%E6%B8%A1%E8%BE%BA-%E4%B8%80%E5%AE%8F/dp/4844336789/ref=la_B004LVAF8Q_1_1?s=books&amp;ie=UTF8&amp;qid=1410066610&amp;sr=1-1">CakePHPで学ぶ継続的インテグレーション</a>でも詳しく解説していますので、CakePHP2の内容ですが、一度手に取ってみてください。
CakePHP3になって、メソッドやクラスが一部変わりましたが、BehatとCakePHPをインテグレーションするためにおさえておかないといけないポイントはほとんど変わっていません。</p>

<p>後はBehat3のドキュメント、CakePHP3のドキュメントを見ながら進めていくと、エンド to エンドのテストが容易に記述できるようになります。</p>

<h3>さいごに</h3>

<p>GithubのREADMEに書いた内容をすべて日本語にした訳ではないのですが、要所をかいつまんで重要な部分を解説しました。
より詳しい内容などはREADMEを見ていただければと思います。</p>

<p>また、BDDプラグインのサンプルアプリにはあった、日本語のシナリオや、JavaScriptを使ったテストなど、Behat3になって大きく変わってはいませんが、サンプルアプリケーションに少しずつ載せられたらなぁと思っています。
何かうまく動かないなどあれば、気軽にGithubのissueに投稿お願いします（日本語でOKです）。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="CakePHP3 のアプリケーションを Behat でテストする" data-url="http://blog.open.tokyo.jp/2015/05/17/cakephp3-behat.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2015/05/17/cakephp3-behat.html&t=CakePHP3%20%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%20Behat%20%E3%81%A7%E3%83%86%E3%82%B9%E3%83%88%E3%81%99%E3%82%8B" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2015/05/17/cakephp3-behat.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2015/05/02/angularjs-ngdialog-ngmodel-not-bind.html">AngularJSでngDialog中の値をngModelでバインドしたいとき注意すること</a></h2>
  <p class="postdate"><a href="/2015/05/02.html" title="Permanent link">Saturday, May 02, 2015 05:19:00 PM</a></p>
  <p class="tags">
      <a href="/tags/javascript.html" rel="tag">JavaScript</a>
      <a href="/tags/angularjs.html" rel="tag">AngularJS</a>
      <a href="/tags/ngdialog.html" rel="tag">ngDialog</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p>AngularJS でモーダルダイアログを表示するために、何を使うでしょうか？
多くの場合 <a href="https://github.com/likeastore/ngDialog">ngDialog</a> というコンポーネントを使うのではないかと思います。</p>

<p>で、ダイアログ上の値は、それを表示したコントローラのスコープにバインドする、という良くあるシナリオを想定してください。</p>

<p>まずうまく<a href="https://jsfiddle.net/sizuhiko/ox73fktc/1/">動作するサンプル</a>を紹介します。</p>

<p><code>Open Dialog</code>というリンクをクリックして、ダイアログを表示したら、チェックボックスをON/OFFしてください。
ダイアログ背景のページで <code>check: true</code> と <code>check: false</code> がトグルするはずです。</p>
<div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;div</span> <span class="na">data-ng-app=</span><span class="s">"myApplication"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">data-ng-controller=</span><span class="s">"MainController"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">ng-click=</span><span class="s">"ShowNgDialog()"</span><span class="nt">&gt;</span>Open Dialog<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;span&gt;</span>check: {{FormData.allcheck}}<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">myApplication</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">myApplication</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">ngDialog</span><span class="dl">'</span><span class="p">]);</span>

<span class="nx">myApplication</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">MainController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">ngDialog</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">FormData</span><span class="o">=</span><span class="p">{</span><span class="na">allcheck</span><span class="p">:</span> <span class="kc">false</span><span class="p">};</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">ShowNgDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">ngDialog</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span>            
            <span class="na">template</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;div&gt;&lt;input type="checkbox" ng-model="FormData.allcheck"/&gt;&lt;/div&gt;</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">plain</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">scope</span><span class="p">:</span><span class="nx">$scope</span>

        <span class="p">});</span>
    <span class="p">}</span>    
<span class="p">});</span>
</code></pre></div>
<p>とても簡単な例ですが、AngularJSを使ってモーダルダイアログを表示して、チェックボックスの値をコントローラのスコープ変数 <code>FormData.allcheck</code> にバインドしています。</p>

<h3>なぜか変数だとバインドされない</h3>

<p>一方で、こちらは<a href="http://jsfiddle.net/sizuhiko/ox73fktc/2/">動作しないサンプル</a>です。</p>

<p><code>Open Dialog</code>というリンクをクリックして、ダイアログを表示したら、チェックボックスをON/OFFしてください。
ダイアログ背景のページは <code>check: false</code> のままです。</p>
<div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;div</span> <span class="na">data-ng-app=</span><span class="s">"myApplication"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">data-ng-controller=</span><span class="s">"MainController"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">ng-click=</span><span class="s">"ShowNgDialog()"</span><span class="nt">&gt;</span>Open Dialog<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;span&gt;</span>check: {{allcheck}}<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">myApplication</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">myApplication</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">ngDialog</span><span class="dl">'</span><span class="p">]);</span>

<span class="nx">myApplication</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">MainController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">ngDialog</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">allcheck</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">ShowNgDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">ngDialog</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span>            
            <span class="na">template</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;div&gt;&lt;input type="checkbox" ng-model="allcheck"/&gt;&lt;/div&gt;</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">plain</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">scope</span><span class="p">:</span><span class="nx">$scope</span>

        <span class="p">});</span>
    <span class="p">}</span>    
<span class="p">});</span>
</code></pre></div>
<p>変わったのは、コントローラのスコープ変数にバインドするオブジェクトです。</p>

<p>うまく動作するのは <code>$scope.FormData={allcheck: false};</code> のようにスコープのプロパティはオブジェクトで、オブジェクトに値を保持しているケースです。
一方うまく動作しないのは <code>$scope.allcheck = false;</code> のようにスコープのプロパティに変数で値を保持しているケースです。</p>

<h3>ngDialogでなければ変数でバインドできる</h3>

<p>ngDialogでなく普通に表示される範囲にある場合は、<a href="http://jsfiddle.net/sizuhiko/ox73fktc/3/">動作するサンプル</a>です。</p>

<p>チェックボックスをON/OFFしてください。ページで <code>check: true</code> と <code>check: false</code> がトグルするはずです。</p>
<div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;div</span> <span class="na">data-ng-app=</span><span class="s">"myApplication"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">data-ng-controller=</span><span class="s">"MainController"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">ng-model=</span><span class="s">"allcheck"</span><span class="nt">/&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;span&gt;</span>check: {{allcheck}}<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">myApplication</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">myApplication</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">ngDialog</span><span class="dl">'</span><span class="p">]);</span>

<span class="nx">myApplication</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">MainController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">ngDialog</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">allcheck</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>
<h3>まとめ</h3>

<p>ngDialogを使うときのちょっとした小ネタなのですが、解決策を見つけるまで結構時間がかかりました。
もし、ngDialogを使ってうまくデータバィンディングできない！という人の参考になればと思います。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="AngularJSでngDialog中の値をngModelでバインドしたいとき注意すること" data-url="http://blog.open.tokyo.jp/2015/05/02/angularjs-ngdialog-ngmodel-not-bind.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2015/05/02/angularjs-ngdialog-ngmodel-not-bind.html&t=AngularJS%E3%81%A7ngDialog%E4%B8%AD%E3%81%AE%E5%80%A4%E3%82%92ngModel%E3%81%A7%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89%E3%81%97%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D%E6%B3%A8%E6%84%8F%E3%81%99%E3%82%8B%E3%81%93%E3%81%A8" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2015/05/02/angularjs-ngdialog-ngmodel-not-bind.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>

  <p class="pagenav">
      <a href="/page/23/">« Prev</a>
        <a href="/page/20/">20</a>
        <a href="/page/21/">21</a>
        <a href="/page/22/">22</a>
        <a href="/page/23/">23</a>
        <b>24</b>
        <a href="/page/25/">25</a>
        <a href="/page/26/">26</a>
        <a href="/page/27/">27</a>
        <a href="/page/28/">28</a>
      <a href="/page/25/">Next »</a>
  </p>
<script type="text/javascript" src="/javascripts/image-resize-ie.js"></script>



        </div>
      </div>

      <div id="sidewrap">
        <div id="side">
          <div class="sidebox sidelinx">
            <h2>Recent Articles</h2>
            <div class="pad">
              <ul>
                  <li><a href="/2023/04/13/ts-jest-will-gradually-opt-in-adoption-of-esbuild-swc-more-to-improve-the-performance.html">ts-jest が esbuild/swc をトランスフォーマーに使って高速化していた</a> <span>2023/04/13</span></li>
                  <li><a href="/2023/04/11/aws-sdk-v3-to-peer-for-your-library.html">aws-sdk v3 を使うライブラリを作ったときは、なるべく peerDependencies に設定しよう</a> <span>2023/04/11</span></li>
                  <li><a href="/2023/04/06/aws-sdk-v2-will-be-mentenance-mode-in-2023.html">aws-sdk v2 が 2023 年中にメンテナンスモードになる</a> <span>2023/04/06</span></li>
                  <li><a href="/2023/04/05/aws-sdk-v3-changed-enum-to-const.html">Node.js v18 / aws-sdk v3 の Lambda アプリが突然動かなくなる</a> <span>2023/04/05</span></li>
                  <li><a href="/2023/04/04/aws-sdk-v3-compile-error-2.html">aws-sdk v3 でコンパイルエラーになる - その２</a> <span>2023/04/04</span></li>
                  <li><a href="/2023/04/03/aws-sdk-v3-ts2345.html">aws-sdk v3 で TS2345 が出てコンパイルエラーになる</a> <span>2023/04/03</span></li>
                  <li><a href="/2023/02/02/how-mock-aws-sdk-client-mock.html">aws-sdk-client-mock はどのように aws-sdk をモックしているのか？</a> <span>2023/02/02</span></li>
                  <li><a href="/2023/01/04/migrate-aws-sdk-node-js-v2-to-v3.html">AWS Lambda の Node.js 14 を 18 に移行する（aws-sdk v3 移行編）</a> <span>2023/01/04</span></li>
                  <li><a href="/2022/12/30/migrate-aws-lambda-node-js-14-to-18.html">AWS Lambda の Node.js 14 を 18 に移行する（CI/CD環境移行編）</a> <span>2022/12/30</span></li>
                  <li><a href="/2022/12/18/fake-aws-events-for-testing-on-node-js.html">Node.js で Lambda ハンドラのテストを書くときに AWS イベントを生成する</a> <span>2022/12/18</span></li>
              </ul>
            </div>
          </div>
          <div class="sidebox" id="tagcloud">
            <h2>Tags</h2>
            <div class="pad">
              <ul class="nobullets clearfix">
                    <li class="size2">
                      <a href="/tags/typescript.html" rel="tag">TypeScript</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/jest.html" rel="tag">Jest</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/javascript.html" rel="tag">JavaScript</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/aws-sdk.html" rel="tag">aws-sdk</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/aws-sdk-v3.html" rel="tag">aws-sdk@v3</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/aws.html" rel="tag">AWS</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/import-maps.html" rel="tag">import maps</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/dependencies-management.html" rel="tag">Dependencies Management</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/dependabot.html" rel="tag">dependabot</a>
                    </li>
                    <li class="size5">
                      <a href="/tags/php.html" rel="tag">PHP</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/gcp.html" rel="tag">GCP</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/asucon.html" rel="tag">asucon</a>
                    </li>
                    <li class="size4">
                      <a href="/tags/polymer.html" rel="tag">Polymer</a>
                    </li>
                    <li class="size3">
                      <a href="/tags/polymer-co-edo.html" rel="tag">Polymer.co-edo</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/chirimen.html" rel="tag">CHIRIMEN</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/iot.html" rel="tag">IoT</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/wot.html" rel="tag">WoT</a>
                    </li>
                    <li class="size4">
                      <a href="/tags/cakephp.html" rel="tag">CakePHP</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/cakefest.html" rel="tag">CakeFest</a>
                    </li>
                    <li class="size2">
                      <a href="/tags/webcomponents.html" rel="tag">WebComponents</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/toiletevolution.html" rel="tag">ToiletEvolution</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/web-components.html" rel="tag">Web Components</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/phpkansai.html" rel="tag">phpkansai</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/phpcon.html" rel="tag">PHPcon</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/cakephp3.html" rel="tag">CakePHP3</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/bdd.html" rel="tag">BDD</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/behat.html" rel="tag">Behat</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/fixture.html" rel="tag">fixture</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/test.html" rel="tag">Test</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/phpmatsuri.html" rel="tag">phpmatsuri</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/coverflow.html" rel="tag">CoverFlow</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/flex.html" rel="tag">Flex</a>
                    </li>
              </ul>
            </div>
          </div>
          <div class="sidebox sidelinx">
            <h2>By Year</h2>
            <div class="pad">
              <ul>
                  <li><a href="/2023.html">2023</a> (8)</li>
                  <li><a href="/2022.html">2022</a> (14)</li>
                  <li><a href="/2021.html">2021</a> (1)</li>
                  <li><a href="/2020.html">2020</a> (6)</li>
                  <li><a href="/2019.html">2019</a> (41)</li>
                  <li><a href="/2018.html">2018</a> (31)</li>
                  <li><a href="/2017.html">2017</a> (7)</li>
                  <li><a href="/2016.html">2016</a> (5)</li>
                  <li><a href="/2015.html">2015</a> (13)</li>
                  <li><a href="/2014.html">2014</a> (14)</li>
                  <li><a href="/2013.html">2013</a> (6)</li>
                  <li><a href="/2012.html">2012</a> (7)</li>
                  <li><a href="/2011.html">2011</a> (11)</li>
                  <li><a href="/2010.html">2010</a> (3)</li>
                  <li><a href="/2009.html">2009</a> (10)</li>
                  <li><a href="/2008.html">2008</a> (16)</li>
              </ul>
            </div>
          </div>
          <div class="sidebox sidelinx">
            <h2>Twitter</h2>
            <a class="twitter-timeline" href="https://twitter.com/sizuhiko" data-widget-id="442558418625114112">@sizuhiko からのツイート</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          </div>
        </div>
      </div>

      <div id="footer">
        <div id="footer2">
          <div class="clear"></div>
        </div>
    </div>
  </body>
</html>
