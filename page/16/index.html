<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>sizuhiko - Technote</title>
    <link rel="shortcut icon" href="/imgages/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/stylesheets/main.css" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/socialite.min.js"></script>
    <script type="text/javascript" src="http://www.scribd.com/javascripts/scribd_api.js"></script>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="/stylesheets/browsers/ie.css" type="text/css">
      <script src="/javascripts/browsers/ie8.js"></script>
      <script defer src="/javascripts/browsers/ie-css3.js"></script>
    <![endif]-->
    <!--[if IE 6]>
      <link rel="stylesheet" href="/styleseets/browsers/ie6.css" type="text/css">
    <![endif]-->
    <!--[if IE 7]>
      <link rel="stylesheet" href="/styleseets/browsers/ie7.css" type="text/css">
    <![endif]-->
    <!--[if IE 8]>
      <link rel="stylesheet" href="/stylesheets/browsers/ie8.css" type="text/css">
    <![endif]-->
    <style type="text/css">
      @media all and (max-width:680px) {
        #blogtools a, #blogtools a:link, #blogtools a:visited { position:relative; top:0; margin:0 0 5px 10px; float:left; background:#f1f1f1; color:#111; border:1px solid #888; }
        #postcontent, #posttitle { width:100%; }
        #qppreview { display:none; }
        #qpsubmit { width:auto !important; float:none; line-height:1.4; height:auto; margin:7px 0; }
        #postform b { display:block; }
        #sharing { float:none; padding-top:3px; }
        }
    </style>
    <style type="text/css">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .cm {
  color: #999988;
  font-style: italic;
}
.highlight .cp {
  color: #999999;
  font-weight: bold;
}
.highlight .c1 {
  color: #999988;
  font-style: italic;
}
.highlight .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #999988;
  font-style: italic;
}
.highlight .err {
  color: #a61717;
  background-color: #e3d2d2;
}
.highlight .gd {
  color: #000000;
  background-color: #ffdddd;
}
.highlight .ge {
  color: #000000;
  font-style: italic;
}
.highlight .gr {
  color: #aa0000;
}
.highlight .gh {
  color: #999999;
}
.highlight .gi {
  color: #000000;
  background-color: #ddffdd;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .gt {
  color: #aa0000;
}
.highlight .kc {
  color: #000000;
  font-weight: bold;
}
.highlight .kd {
  color: #000000;
  font-weight: bold;
}
.highlight .kn {
  color: #000000;
  font-weight: bold;
}
.highlight .kp {
  color: #000000;
  font-weight: bold;
}
.highlight .kr {
  color: #000000;
  font-weight: bold;
}
.highlight .kt {
  color: #445588;
  font-weight: bold;
}
.highlight .k, .highlight .kv {
  color: #000000;
  font-weight: bold;
}
.highlight .mf {
  color: #009999;
}
.highlight .mh {
  color: #009999;
}
.highlight .il {
  color: #009999;
}
.highlight .mi {
  color: #009999;
}
.highlight .mo {
  color: #009999;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #009999;
}
.highlight .sa {
  color: #000000;
  font-weight: bold;
}
.highlight .sb {
  color: #d14;
}
.highlight .sc {
  color: #d14;
}
.highlight .sd {
  color: #d14;
}
.highlight .s2 {
  color: #d14;
}
.highlight .se {
  color: #d14;
}
.highlight .sh {
  color: #d14;
}
.highlight .si {
  color: #d14;
}
.highlight .sx {
  color: #d14;
}
.highlight .sr {
  color: #009926;
}
.highlight .s1 {
  color: #d14;
}
.highlight .ss {
  color: #990073;
}
.highlight .s, .highlight .dl {
  color: #d14;
}
.highlight .na {
  color: #008080;
}
.highlight .bp {
  color: #999999;
}
.highlight .nb {
  color: #0086B3;
}
.highlight .nc {
  color: #445588;
  font-weight: bold;
}
.highlight .no {
  color: #008080;
}
.highlight .nd {
  color: #3c5d5d;
  font-weight: bold;
}
.highlight .ni {
  color: #800080;
}
.highlight .ne {
  color: #990000;
  font-weight: bold;
}
.highlight .nf, .highlight .fm {
  color: #990000;
  font-weight: bold;
}
.highlight .nl {
  color: #990000;
  font-weight: bold;
}
.highlight .nn {
  color: #555555;
}
.highlight .nt {
  color: #000080;
}
.highlight .vc {
  color: #008080;
}
.highlight .vg {
  color: #008080;
}
.highlight .vi {
  color: #008080;
}
.highlight .nv, .highlight .vm {
  color: #008080;
}
.highlight .ow {
  color: #000000;
  font-weight: bold;
}
.highlight .o {
  color: #000000;
  font-weight: bold;
}
.highlight .w {
  color: #bbbbbb;
}
.highlight {
  background-color: #f8f8f8;
}
    </style>
    <script type="text/javascript">
      $(document).ready(function() {
        Socialite.load("blog-social");
      });
    </script>

  </head>
  <body id="myopera" data-twttr-rendered="true">
    <!--[if IE 6]><div class="ie6"><![endif]-->
    <!--[if IE 7]><div class="ie7"><![endif]-->
    <!--[if IE 8]><div class="ie8"><![endif]-->
    <!--[if IE 9]><div class="ie9"><![endif]-->
    <div id="wrap0"><div id="wrap1"><div id="wrap2"><div id="wrap3"><div id="wrap4">

    <div id="top" class="top-blog">
      <div id="top2">
        <h1><a href="/" title="home"><span>Technote</span></a></h1>
        <p id="subtitle"><span>by sizuhiko</span></p>
      </div>
    </div>

    <div id="content" class="blogfront">
      <div id="mainwrap">
        <div id="main">

            <h2 class="title"><a href="/2018/12/09/kddi-digital-gate-hacks.html">KDDI DIGITAL GATE HACKSのお手伝いをしてきました</a></h2>
  <p class="postdate"><a href="/2018/12/09.html" title="Permanent link">Sunday, December 09, 2018 06:11:00 PM</a></p>
  <p class="tags">
      <a href="/tags/iot.html" rel="tag">IoT</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p>KDDI学生向けハッカソン<a href="https://www.kdghacks.com/">KDDI DIGITAL GATE HACKS 2018</a>でチューターとしてお手伝いをしてきました。
どんなハッカソンなのかは<a href="https://techplay.jp/event/697271">TECH PLAYのイベントサイト</a>の方がわかりやすいかも。</p>

<p><a href="https://soracom.jp/products/module/wio_lte_m1_nb1/">SORACOMのWio LTE M1/NB1</a>を使って、家での生活をワクワクさせるIoTサービスを創るイベントです。</p>

<p>たくさんの大学生/大学院生が参加されて、みなさん優秀だったのでチューターとしては特にやることも少なくて、とにかく楽しいという感想が残るイベントでした。</p>

<p>詳細はイベント主催であるKDDIさんからブログが公開されるのではないかと思うので、準備秘話というか「Wio LTE M1/NB1」(以後WioLTE青)のつらさを書いておきます。</p>

<p>WioLTEとはSeeedが開発しSORACOMで販売しているボードです。
これまでに</p>

<ul>
<li><a href="https://soracom.jp/products/module/wio_lte">Wio LTE JP Version</a> 以降WioLTE赤</li>
<li><a href="https://soracom.jp/products/module/wio_3g_soracom_edition">Wio 3G SORACOM Edition</a></li>
</ul>

<p>が発売されています。WioLTE青はKDDIのSIMが利用できるのが特徴です。</p>

<p>ということで、チューターはサンプルプログラムを作ったりといった準備をしていました。
私は個人的にWioLTE赤を購入して使っていたので、その感覚でWioLTE青を使い始めたのですが、似ているのですが、だいぶ違うものなので、これから触る人は少し注意が必要です。</p>

<h3>WioLTE青の良いところ</h3>

<ul>
<li>KDDIのSIMが使える</li>
<li>DFUモードが不要なので、Arduino IDEからのプログラムの書き込みが簡単</li>
</ul>

<h3>WioLTE青の困ったところ</h3>

<ul>
<li>サンプルが少ない。でも今回たくさん作ったので<a href="https://github.com/kdg-hacks/kdg-hacks-examples">kdg-hacks-examples</a>が役に立つと良いな、と思っています。</li>
<li>I2C通信にWireが使えない。WireI2Cを使うので既存のArduino向けライブラリを簡単に使えない。</li>
<li>WioLTE赤と違って使っている人が少ないのでノウハウが少ない</li>
<li>WioLTE赤は5Vセンサーでも電源だけ5Vを給電すれば5Vセンサー値も読み取れたが、どうもそれはできないっぽい</li>
<li>interrupts/noInterruptsメソッドがArduino-Coreに実装されていないので、タイミング重要なNeoPixelといったテープLEDが使えなかった（ライブラリ使うとコンパイルとおらない）</li>
<li><a href="https://github.com/SeeedJP/stm32f4ArduinoCore">STM32F405/407のArduinoCore</a>の実装がプアなので、Arduinoだと思うとハマる</li>
</ul>

<p>ということでGroveのセンサーだいたい使える、と思っていると5V必要だったりするセンサーが絶望的に動きません。</p>

<h3>でも良いボード</h3>

<p>IoTでWiFiとかかなりつらいし、LTE使えるだけでも魅力てきなので、例えば苦手な部分はArduinoで実装してI2Cスレーブとして、WioLTEから操作するのはアリかな、というか、そういう使い方が良いと思っています。悩まなくて良いし、開発スピードも増します。</p>

<h3>まとめ</h3>

<p>学生向けハッカソンへの参加はとても新鮮で楽しかったです。
また機会があればイベントに協力していきたいなと思います。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="KDDI DIGITAL GATE HACKSのお手伝いをしてきました" data-url="http://blog.open.tokyo.jp/2018/12/09/kddi-digital-gate-hacks.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2018/12/09/kddi-digital-gate-hacks.html&t=KDDI%20DIGITAL%20GATE%20HACKS%E3%81%AE%E3%81%8A%E6%89%8B%E4%BC%9D%E3%81%84%E3%82%92%E3%81%97%E3%81%A6%E3%81%8D%E3%81%BE%E3%81%97%E3%81%9F" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2018/12/09/kddi-digital-gate-hacks.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2018/12/09/assistant-developer-conference-vol-1.html">Assistant Developer Conference vol.1で仕事でやっていることの発表をしました</a></h2>
  <p class="postdate"><a href="/2018/12/09.html" title="Permanent link">Sunday, December 09, 2018 06:00:00 PM</a></p>
  <p class="tags">
      <a href="/tags/actions-on-google.html" rel="tag">Actions on Google</a>
      <a href="/tags/googlehome.html" rel="tag">GoogleHome</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p>Assistant Developer Community JapanのSlack(assistant-dev-ja.slack.com)に入って情報収集したり、
普段仕事で得たTipsなどを共有したりしているのですが、
そこで運用の話で盛り上がったところ、セッションのお誘いをいただいたので、開発チームのメンバーと一緒に発表してきました。</p>

<p><a href="https://aogdevsja.connpass.com/event/107408/">Assistant Developer Conference vol.1</a>の2番目で「家電操作の発話ログ収集と今後の展望」というタイトルです。</p>

<p>発表資料はまだOKが出てないので公開できないのですが、いわゆるスマートホームアクションの話をしてきました。
資料公開できたら追加でリンクします。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Assistant Developer Conference vol.1で仕事でやっていることの発表をしました" data-url="http://blog.open.tokyo.jp/2018/12/09/assistant-developer-conference-vol-1.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2018/12/09/assistant-developer-conference-vol-1.html&t=Assistant%20Developer%20Conference%20vol.1%E3%81%A7%E4%BB%95%E4%BA%8B%E3%81%A7%E3%82%84%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AE%E7%99%BA%E8%A1%A8%E3%82%92%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2018/12/09/assistant-developer-conference-vol-1.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2018/11/18/jsfes-2018-autumn.html">秋のJavaScript祭りに参加して、Web ComponentsについてLTをしました</a></h2>
  <p class="postdate"><a href="/2018/11/18.html" title="Permanent link">Sunday, November 18, 2018 05:46:00 PM</a></p>
  <p class="tags">
      <a href="/tags/polymer.html" rel="tag">Polymer</a>
      <a href="/tags/web-components.html" rel="tag">Web Components</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p><a href="https://javascript-fes.doorkeeper.jp/events/81307">11/17に開催されたJavaScript祭りに参加しました</a></p>

<p><img src="https://dzpp79ucibp5a.cloudfront.net/events_banners/81307_normal_1539135553_JavaScript2018.png" alt="" /></p>

<p>いつもと同様にLT枠へ申し込み、この半年でおきたPolymerのアップデートを発表しました。
とは言いつつ、Polymerのアップデートは少なめで、Chrome Dev Summit で発表された内容を中心に話しました。</p>

<p>今回は、春のイベントで強烈な印象を残したCanvasだけで実装したゲームのLTについて、20分枠で聴けるというのが楽しみでした。
実際20分枠よりももっと聞きたいという感じでしたし、相変わらずすごい。実装も進んでいて、もう1つゲームが公開されていました。</p>

<p>さて、私のスライドは以下のとおりです。</p>

<script async class="speakerdeck-embed" data-id="1626d453738e4ad2a7b4150a744c967b" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>

<p>いつもちょうどJavaScript祭りの直前にアナウンスがあるので、発表ネタには困りませんが、最近多忙でなかなか動画を見る時間を作れずギリギリまでスライド内容が決まらなかった&hellip;.</p>

<p>富士通クラウドテクノロジーさんはUSB-C x HDMIとの相性が悪いのが、以前のPolymerイベントでわかっていたので、事前に運営へお知らせしていたのですが、やっぱりバタバタになってしまっていたのが残念でした。
なんとか改善されると良いなーと思っています。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="秋のJavaScript祭りに参加して、Web ComponentsについてLTをしました" data-url="http://blog.open.tokyo.jp/2018/11/18/jsfes-2018-autumn.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2018/11/18/jsfes-2018-autumn.html&t=%E7%A7%8B%E3%81%AEJavaScript%E7%A5%AD%E3%82%8A%E3%81%AB%E5%8F%82%E5%8A%A0%E3%81%97%E3%81%A6%E3%80%81Web%20Components%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6LT%E3%82%92%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2018/11/18/jsfes-2018-autumn.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2018/11/09/polymer-co-edo-meetup-18.html">Polymer.coedo ＃18を開催しました</a></h2>
  <p class="postdate"><a href="/2018/11/09.html" title="Permanent link">Friday, November 09, 2018 05:35:00 PM</a></p>
  <p class="tags">
      <a href="/tags/polymer.html" rel="tag">Polymer</a>
      <a href="/tags/polymer-co-edo.html" rel="tag">Polymer.co-edo</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p>今年9回目となる <a href="https://polymercoedo.doorkeeper.jp/events/81714">Polymer.co-edo ミートアップ</a> を開催しました。</p>

<p>今回からしばらくは「Edoエレメントの制作とWeb Componentsもくもく」ということで、進めることにしました。</p>

<p>とりあえず以下のオーガナイゼーションを作成して準備を整えました。</p>

<ul>
<li><a href="https://github.com/Edo-Elements">Edo-Elements - Github</a></li>
<li>edo-elements の npm オーガナイゼーション（これはまだ何もpublishしていないので、リンクにできない&hellip;.）</li>
</ul>

<p>イベントに参加いただけたらオーガナイゼーションに招待しようと思うので、よろしくお願いします。</p>

<h3>次回は</h3>

<p>予定どおり開催できる見込みです。
<a href="https://polymercoedo.doorkeeper.jp/">Doorkeeperのコミュニティページ</a>に今年の予定も書いてあるので参考にしてください。</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Polymer.coedo ＃18を開催しました" data-url="http://blog.open.tokyo.jp/2018/11/09/polymer-co-edo-meetup-18.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2018/11/09/polymer-co-edo-meetup-18.html&t=Polymer.coedo%20%EF%BC%8318%E3%82%92%E9%96%8B%E5%82%AC%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2018/11/09/polymer-co-edo-meetup-18.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>
  <h2 class="title"><a href="/2018/10/23/cakephp2-plugin-travis-issue.html">CakePHP2プラグインをTravisCIでビルドしているときに気をつけること</a></h2>
  <p class="postdate"><a href="/2018/10/23.html" title="Permanent link">Tuesday, October 23, 2018 10:58:00 AM</a></p>
  <p class="tags">
      <a href="/tags/cakephp.html" rel="tag">CakePHP</a>
      <a href="/tags/cakephp2.html" rel="tag">CakePHP2</a>
      <a href="/tags/travisci.html" rel="tag">TravisCI</a>
      <a href="/tags/ci.html" rel="tag">CI</a>
      <a href="/tags/fabricate.html" rel="tag">Fabricate</a>
  </p>
  <div class="content">
    <!-- use article.summary(250) if you have Nokogiri available to show just
       the first 250 characters -->
    <p>先日 <a href="https://twitter.com/tenkoma">@tenkoma</a> さんが、<a href="https://github.com/sizuhiko/Fabricate">Fabricate</a> に <a href="https://github.com/sizuhiko/Fabricate/pull/30">PR</a> をくれました。
しかももう枯れてる <a href="https://github.com/sizuhiko/Fabricate/tree/cakephp2">CakePHP2版</a> に。ありがたやー、と思っていましたら&hellip;</p>

<p><a href="https://travis-ci.org/sizuhiko/Fabricate/builds/443036544">CIのビルドが失敗</a>しています。</p>

<p>おや？<a href="https://travis-ci.org/sizuhiko/Fabricate/jobs/246923803">直前までは通過</a>していて、<a href="https://github.com/sizuhiko/Fabricate/pull/30">READMEのtypoが修正された</a>だけなんですが&hellip;</p>

<p>（ただ直前は1年も前なのだが&hellip;）</p>

<h3>ためしにRebuildしてみる</h3>

<p>そういう小手先の問題ではないようだ&hellip;.</p>

<h3>TravisCIに書いてあるスクリプトの手順をローカルで実行してみる</h3>

<p>うまく動く&hellip;</p>

<h3>ビルド失敗の問題とは</h3>

<p><a href="https://travis-ci.org/sizuhiko/Fabricate/jobs/444524331">失敗ビルドの一例</a>でわかるとおり、PHPUnitのバージョンが期待値ではありません。</p>

<p>CakaPHP2ではPHPUnit3.7系しか使えません。
<a href="https://github.com/cakephp/cakephp/blob/2.x/lib/Cake/TestSuite/CakeTestSuiteDispatcher.php#L135">CakeTestSuiteDispatcherでPHPUnitのロード</a>を試みていて、もしロードできないと<a href="https://github.com/cakephp/cakephp/blob/2.x/lib/Cake/Console/Command/TestShell.php#L179">TestShellでエラー</a>になります。</p>

<p>CakePHP2のプラグインのテストを簡単に実行できるようにするため<a href="https://github.com/FriendsOfCake/travis">FriendsOfCake/travis</a>を使っています。
このTravis用ツールは、PHPUnit3.7をインストールして、 <code>Vendor</code> の下にリンクしてくれるので、うまくPHPUnitは見つかるはずなのですが。</p>

<p>想定される原因としては、以下のような感じです。</p>

<ul>
<li>PHPUnitが見つからない</li>
<li>新しいPHPUnitが見つかった</li>
</ul>

<h3>CakePHPの日本語Slackで相談してみる</h3>

<p>https://cakesf.slack.com/archives/C1FT02VQA/p1539927224000100</p>

<blockquote>
<p>CakePHP2系のプラグインをTravis CIでテストするのに
https://github.com/FriendsOfCake/travis
を使っているのですが、PHPUnitへの参照がうまくできなくなっていて、解決した人っていたりしますか？
個人的に修正できそうなんて、試してみようかと思ったのですが、すでに対応済みの人がいたらなーと思い、聞いてみたいです</p>
</blockquote>

<p>他のCakePHP2プラグインはビルド通っているのか？</p>

<ul>
<li>https://github.com/lampager/lampager-cakephp2 は5ヶ月ぐらい前に<a href="https://travis-ci.org/lampager/lampager-cakephp2/builds/387421969">通過している</a>。でもPHPUnitのバージョンが新しい</li>
<li>https://github.com/cakephp/debug_kit/tree/2.2 はPHPUnit3.7使っているけど、 <a href="https://github.com/FriendsOfCake/travis">FriendsOfCake/travis</a> を使ってない。ビルドは<a href="https://travis-ci.org/cakephp/debug_kit/builds/429846172">最近通過</a>している</li>
<li>https://github.com/tsmsogn/Pas/ は <a href="https://github.com/FriendsOfCake/travis">FriendsOfCake/travis</a> を使っていて、Slackで相談したらビルドまでしていただけた。ありがたや。<a href="https://travis-ci.org/tsmsogn/Pas/builds/249863706">通過</a>している。</li>
</ul>

<h3>とにかくいろいろ試す</h3>

<p>試すのに、別のブランチを切れば良かったのですが、まぁ簡単になおるだろうと <code>Fabricate/cakephp2</code> ブランチで作業したのは、ちょっと後悔しています&hellip;.</p>

<ul>
<li>◎ <a href="https://github.com/FriendsOfCake/travis/blob/master/before_script.sh">FriendsOfCake/travisのbefore_script.sh</a> を呼び出す方法が、 <code>travis_wait</code> 付きに変わっていたので<a href="https://github.com/sizuhiko/Fabricate/commit/046548930effc61affab8acd0b64b974d52005d8">追従した</a>。ビルドが不安定なことがあったが安定した</li>
<li>× <a href="https://github.com/FriendsOfCake/travis">FriendsOfCake/travis</a> をローカルに fork して、ログを仕込んだりしてビルドを試みた（何も意味はなかった）</li>
<li>× <a href="https://github.com/FriendsOfCake/travis/blob/master/before_script.sh">FriendsOfCake/travisのbefore_script.sh</a> で <code>composer global install</code> しているPHPUnitを削除して <code>composer require</code> で入れてみた（変化なし）</li>
<li>× <code>include_path</code> の先頭にPHPUnitへのパスを設定してみた（変化なし）</li>
<li>△ Slackで <code>CAKE_REF</code> 使うと良いかも？というアドバイスをいただいたので、入れてみた。PHPUnitへの参照としては変化がなかったけど、有用そうなのでそのまま採用した。</li>
<li>× 既存で <code>composer.json</code> があるのが、<a href="https://github.com/FriendsOfCake/travis">FriendsOfCake/travis</a>を使っている他のプラグインと違ったので、 <code>.travis.yml</code> の <code>before_script</code> で消してみた（変化なし）</li>
</ul>

<p>で、TravisCIの画面（のビルド結果コンソールではない部分）を見比べていたら、テストが通過している画面にはワーニングが表示されていて、自分のビルドには出ていないことが判明。
さらに<a href="https://travis-ci.org/sizuhiko/Fabricate/jobs/246923803">過去に通過していたビルド</a>にもワーニングが表示されていることを確認した。</p>

<h3>何のワーニング？</h3>

<blockquote>
<p>This job ran on our Precise environment, which is in the process of being decommissioned. Please read about the status of the rollout on the blog, and take note that you can explicitly stay on Precise by specifying dist: precise in your .travis.yml.</p>
</blockquote>

<p>意訳すると「このビルドは、Precise環境で実行されたけど、廃止予定です。もし続けて使いたければ .travis.yml に <code>dist：precise</code> と書いておけばOK。続きはBlogで」みたいなことです。
<a href="https://blog.travis-ci.com/2017-08-31-trusty-as-default-status">the blog</a>も見ておいてください。</p>

<h3>precise 指定でビルドしてみる</h3>

<p><code>.travis.yml</code> に <code>dist：precise</code> を追加してみると&hellip;.</p>

<p>ビルドが通過しました！！</p>

<p>ついでに古い composer.lock と composer.json も更新/削除しておきました。</p>

<h3>詳しく調べた</h3>

<p>現在のTravisでビルドするLinuxイメージは <code>trusty</code> なのですが、そこでPHP5.4などを利用しようとすると以下のようなメッセージがビルドコンソール中に表示されます。</p>

<blockquote>
<p>5.4 is not pre-installed; installing
Downloading archive: https://s3.amazonaws.com/travis-php-archives/binaries/ubuntu/14.04/x86<em>64/php-5.4.tar.bz2
9.31s$ curl -s -o archive.tar.bz2 $archive</em>url &amp;&amp; tar xjf archive.tar.bz2 &ndash;directory /</p>
</blockquote>

<p>ということで、PHPのイメージファイルをダウンロード＆解凍してみました。
すると、PHPUnitが同梱されています。
そのバージョンは <code>PHPUnit 4.8.35</code> でした。
そこかー、それ参照しちゃいましたか&hellip;</p>

<h3>まとめ</h3>

<p>CakePHP2プラグインを作ったことがあって、最近ビルドしていない方は漏れなく同様の事象になると思います。
これは<a href="https://github.com/FriendsOfCake/travis">FriendsOfCake/travis</a>使っている、使っていないに関係なくです。</p>

<p>あなたの <code>.travis.yml</code> に <code>dist：precise</code> が設定されていなければ、今のうちに追加しておきましょう。</p>

<p>ではステキなCakePHPライフを！</p>



    <div class="row">
      <div class="small-12 medium-5 large-5 small-centered columns blog-social">
        <ul class="social-buttons cf">
          <li>
            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="CakePHP2プラグインをTravisCIでビルドしているときに気をつけること" data-url="http://blog.open.tokyo.jp/2018/10/23/cakephp2-plugin-travis-issue.html" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
          </li>
          <li>
            <a href="http://www.facebook.com/sharer.php?u=http://blog.open.tokyo.jp/2018/10/23/cakephp2-plugin-travis-issue.html&t=CakePHP2%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%92TravisCI%E3%81%A7%E3%83%93%E3%83%AB%E3%83%89%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AB%E6%B0%97%E3%82%92%E3%81%A4%E3%81%91%E3%82%8B%E3%81%93%E3%81%A8" class="socialite facebook-like" data-href="http://blog.open.tokyo.jp/2018/10/23/cakephp2-plugin-travis-issue.html" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
          </li>
        </ul>
      </div>
      <div class="clearfix"></div>
    </div>

  </div>

  <p class="pagenav">
      <a href="/page/15/">« Prev</a>
        <a href="/page/12/">12</a>
        <a href="/page/13/">13</a>
        <a href="/page/14/">14</a>
        <a href="/page/15/">15</a>
        <b>16</b>
        <a href="/page/17/">17</a>
        <a href="/page/18/">18</a>
        <a href="/page/19/">19</a>
        <a href="/page/20/">20</a>
      <a href="/page/17/">Next »</a>
  </p>
<script type="text/javascript" src="/javascripts/image-resize-ie.js"></script>



        </div>
      </div>

      <div id="sidewrap">
        <div id="side">
          <div class="sidebox sidelinx">
            <h2>Recent Articles</h2>
            <div class="pad">
              <ul>
                  <li><a href="/2023/04/18/generation-code-aws-sdk-v3.html">AWS SDK v3 のモジュールと利用方法</a> <span>2023/04/18</span></li>
                  <li><a href="/2023/04/13/ts-jest-will-gradually-opt-in-adoption-of-esbuild-swc-more-to-improve-the-performance.html">ts-jest が esbuild/swc をトランスフォーマーに使って高速化していた</a> <span>2023/04/13</span></li>
                  <li><a href="/2023/04/11/aws-sdk-v3-to-peer-for-your-library.html">aws-sdk v3 を使うライブラリを作ったときは、なるべく peerDependencies に設定しよう</a> <span>2023/04/11</span></li>
                  <li><a href="/2023/04/06/aws-sdk-v2-will-be-mentenance-mode-in-2023.html">aws-sdk v2 が 2023 年中にメンテナンスモードになる</a> <span>2023/04/06</span></li>
                  <li><a href="/2023/04/05/aws-sdk-v3-changed-enum-to-const.html">Node.js v18 / aws-sdk v3 の Lambda アプリが突然動かなくなる</a> <span>2023/04/05</span></li>
                  <li><a href="/2023/04/04/aws-sdk-v3-compile-error-2.html">aws-sdk v3 でコンパイルエラーになる - その２</a> <span>2023/04/04</span></li>
                  <li><a href="/2023/04/03/aws-sdk-v3-ts2345.html">aws-sdk v3 で TS2345 が出てコンパイルエラーになる</a> <span>2023/04/03</span></li>
                  <li><a href="/2023/02/02/how-mock-aws-sdk-client-mock.html">aws-sdk-client-mock はどのように aws-sdk をモックしているのか？</a> <span>2023/02/02</span></li>
                  <li><a href="/2023/01/04/migrate-aws-sdk-node-js-v2-to-v3.html">AWS Lambda の Node.js 14 を 18 に移行する（aws-sdk v3 移行編）</a> <span>2023/01/04</span></li>
                  <li><a href="/2022/12/30/migrate-aws-lambda-node-js-14-to-18.html">AWS Lambda の Node.js 14 を 18 に移行する（CI/CD環境移行編）</a> <span>2022/12/30</span></li>
              </ul>
            </div>
          </div>
          <div class="sidebox" id="tagcloud">
            <h2>Tags</h2>
            <div class="pad">
              <ul class="nobullets clearfix">
                    <li class="size1">
                      <a href="/tags/aws-sdk.html" rel="tag">aws-sdk</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/aws-sdk-v3.html" rel="tag">aws-sdk@v3</a>
                    </li>
                    <li class="size2">
                      <a href="/tags/typescript.html" rel="tag">TypeScript</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/jest.html" rel="tag">Jest</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/javascript.html" rel="tag">JavaScript</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/aws.html" rel="tag">AWS</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/import-maps.html" rel="tag">import maps</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/dependencies-management.html" rel="tag">Dependencies Management</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/dependabot.html" rel="tag">dependabot</a>
                    </li>
                    <li class="size5">
                      <a href="/tags/php.html" rel="tag">PHP</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/gcp.html" rel="tag">GCP</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/asucon.html" rel="tag">asucon</a>
                    </li>
                    <li class="size4">
                      <a href="/tags/polymer.html" rel="tag">Polymer</a>
                    </li>
                    <li class="size3">
                      <a href="/tags/polymer-co-edo.html" rel="tag">Polymer.co-edo</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/chirimen.html" rel="tag">CHIRIMEN</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/iot.html" rel="tag">IoT</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/wot.html" rel="tag">WoT</a>
                    </li>
                    <li class="size4">
                      <a href="/tags/cakephp.html" rel="tag">CakePHP</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/cakefest.html" rel="tag">CakeFest</a>
                    </li>
                    <li class="size2">
                      <a href="/tags/webcomponents.html" rel="tag">WebComponents</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/toiletevolution.html" rel="tag">ToiletEvolution</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/web-components.html" rel="tag">Web Components</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/phpkansai.html" rel="tag">phpkansai</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/phpcon.html" rel="tag">PHPcon</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/cakephp3.html" rel="tag">CakePHP3</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/bdd.html" rel="tag">BDD</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/behat.html" rel="tag">Behat</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/fixture.html" rel="tag">fixture</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/test.html" rel="tag">Test</a>
                    </li>
                    <li class="size0">
                      <a href="/tags/phpmatsuri.html" rel="tag">phpmatsuri</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/coverflow.html" rel="tag">CoverFlow</a>
                    </li>
                    <li class="size1">
                      <a href="/tags/flex.html" rel="tag">Flex</a>
                    </li>
              </ul>
            </div>
          </div>
          <div class="sidebox sidelinx">
            <h2>By Year</h2>
            <div class="pad">
              <ul>
                  <li><a href="/2023.html">2023</a> (9)</li>
                  <li><a href="/2022.html">2022</a> (14)</li>
                  <li><a href="/2021.html">2021</a> (1)</li>
                  <li><a href="/2020.html">2020</a> (6)</li>
                  <li><a href="/2019.html">2019</a> (41)</li>
                  <li><a href="/2018.html">2018</a> (31)</li>
                  <li><a href="/2017.html">2017</a> (7)</li>
                  <li><a href="/2016.html">2016</a> (5)</li>
                  <li><a href="/2015.html">2015</a> (13)</li>
                  <li><a href="/2014.html">2014</a> (14)</li>
                  <li><a href="/2013.html">2013</a> (6)</li>
                  <li><a href="/2012.html">2012</a> (7)</li>
                  <li><a href="/2011.html">2011</a> (11)</li>
                  <li><a href="/2010.html">2010</a> (3)</li>
                  <li><a href="/2009.html">2009</a> (10)</li>
                  <li><a href="/2008.html">2008</a> (16)</li>
              </ul>
            </div>
          </div>
          <div class="sidebox sidelinx">
            <h2>Twitter</h2>
            <a class="twitter-timeline" href="https://twitter.com/sizuhiko" data-widget-id="442558418625114112">@sizuhiko からのツイート</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          </div>
        </div>
      </div>

      <div id="footer">
        <div id="footer2">
          <div class="clear"></div>
        </div>
    </div>
  </body>
</html>
