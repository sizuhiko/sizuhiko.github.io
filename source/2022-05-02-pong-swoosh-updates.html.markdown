---
title: pong-swoosh のアップデートまとめ
date: 2022-05-02 07:39 UTC
tags:
- OnlineTool
- pong-swoosh
---

昨年リリースした [pong-swoosh](https://its-succ.github.io/pong-swoosh/) ですが、いつくかのアップデートを重ねてより使いやすくなっている、と感想もいただいております。
そこで、これまでのアップデートをまとめて紹介します。

## βバージョン

実はブログで公表する以前に、身内で試していたβバージョンがあり、そのときはTOPページでチャンネルを開設すると、

- コントローラページ
- スピーカーページ

の2つのURLを共有してもらうように、表示されていました。

すると、2つ共有するのが面倒であるといった意見があり、エントランスページというのを作り、そこに2つのURLとQRコードを載せることにしました。
これが処理リリースバージョン（以前のブログ [オンラインイベントの盛り上がりを効果音で共有するサービス pong-swoosh を作成した](/2021/07/11/pong-swoosh.html) で紹介したものです。

## 初期バージョン

しばらくはデザインの変更はなく、Socket.io 周辺で接続が切れたり、Herokuのインスタンスが再起動したときの再接続などを解消するのがメインでした。

- [チャンネルは削除イベントが送信されたときに削除する](https://github.com/its-succ/pong-swoosh/pull/50)
- [接続できない場合にスナックバーが表示されるように修正](https://github.com/its-succ/pong-swoosh/pull/52)
- [リロードやHeroku再起動時も動作が継続できるようにした](https://github.com/its-succ/pong-swoosh/pull/58)
- [サーバーとの接続が回復したら、自動的に接続するように対応した](https://github.com/its-succ/pong-swoosh/pull/64)

これらの対処で基本的な安定接続が保たれ、ユーザー体験を改善することにフォーカスしていきました。

## UIの改善

ここで、いくつかの改善が実施されました。

- [デフォルト効果音の変更と音量の調整](https://github.com/its-succ/pong-swoosh/pull/62)
- [スピーカー画面に参加人数を表示した](https://github.com/its-succ/pong-swoosh/pull/65)

音量がバラバラな感じだったので、調整しました。
参加人数に関しては、表示して欲しいという要望があったので、スピーカー画面に表示するよう追加されました。

- [チャンネル作成中はローディング画面に切り替えて、操作できないようにしておく](https://github.com/its-succ/pong-swoosh/pull/66)

Herokuのインスタンスがしばらくアクセスされていない、初期起動の状態だとチャンネル作成に時間がかかり
何度も作成ボタンを押してしまうトラブルがあったので、すぐにローディング画面へ切り替えるように。

- [参加者画面を追加して、エントランスの代わりにした](https://github.com/its-succ/pong-swoosh/pull/68)

初期のコンセプトでもあった

> オンラインでイベントに参加すると、参加者一覧の画面と、スライドなど画面共有された画面の2つを常に表示していると思います。
> かなり大きなディスプレイを使っていれば、余裕があるかもしれないのですが、ノートPCとそれほど大きくない外部モニターだと、それぞれが最大表示されていて、画面には余白がないのでは？と思います（私もそうです）。
> そこで、コントローラー画面はスマホでアクセスして利用しやすいように設計されています。
> スピーカー画面は、最初に音量調整すれば特に前面に表示している必要がないので、Web会議システムと同じPCで開くことが想定されています。
> もちろんWeb会議の音と混じるのが嫌な人もいると思うので、どちらもスマホからアクセスしやすいようにQRコードを表示するようにしています。

この考え方、エントランスページからスピーカーはPC、コントローラはスマホ、というのが思いの外PCのみでも操作で良い人が多いということがわかりました。
なので、エントランスページはなくして、共有されたURLがいきなり参加者側のアプリケーション画面という流れにしました。
なので、共有したURLから画面遷移する必要がありません。
参加者画面にはスマホでコントローラを表示できるQRコードを表示するようにしたので、もしスマホから操作という場合も従来のステップ数からは
変更なく利用できるようになっています。

## 速度の改善

- [効果音はクライアント側で読み込むように変更](https://github.com/its-succ/pong-swoosh/pull/85)

これまではSocket.ioのメッセージの中にバイナリで効果音を送信するようにしていたのですが、同じオリジンに効果音を設置するようにし、
ブラウザから効果音をロードする変更を実施しました。
これによって、効果音ボタンを押したときにブロードキャストされるメッセージは効果音IDぐらいになってので、送信コストが下がりより大人数でも時差なく
効果音が鳴るようになりました（これまでは30人ぐらいのイベントだと少しタイムラグがあった）。

## テストコードの追加

OSSでの活動でもあるので、多くの人から改善リクエストを受け付けられるように、サーバーサイドからテストコードを追加しています。
まだ途中ですが、フロントエンドがSveltteということもあり、そのテストツールでもある [uvu](https://github.com/lukeed/uvu) を利用しています。

## 実は pong-swoosh はプライベートβから１周年

pong-swoosh の初期実装をプライベートβで利用し始めたのは、ちょうど1年前のGW明けでした。
そのときに、まだオンラインカンファレンスやミーティングがどのぐらい続くのかわからない中、まだ必要としてくれる人がいれば、という思いではじめてきて
1年が経過しようとしています。

まだオンラインの需要はあるようですので、引き続き pong-swoosh の改善をしていきたいと思います。
